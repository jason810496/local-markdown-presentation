<!DOCTYPE html>
<html >

<head>
    <meta charset="utf-8">
    <!-- test search cdn -->
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
    <!-- boostwrap cdn -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <title>Select Slide</title>
</head>

<body data-bs-theme="dark">
    <nav class="navbar navbar-dark bg-info justify-content-md-between px-4" >
        <a class="navbar-brand">Available slides</a>
        <div class="form-inline mr-2" >
            <input class="form-control mr-sm-2 text-light" type="search" placeholder="Search" aria-label="Search" onkeyup="search(event)" style="background-color: #01809a; border: solid 3px #0baccc; ">
        </div>
    </nav>
    <div class="my-4" id="slideList" >

    </div>

    <div id="card-template" style="visibility: hidden; position:fixed;">
        <div class="card m-auto mb-3" style="background-color: #272e34; width: 18rem;">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h5 class="card-title">Demo 1</h5>
                        <p class="card-text mb-1">Slide 1</p>
                        <pre class="card-name mb-0">Markdown.md</pre>
                    </div>
                    <div class="d-flex flex-column justify-content-center">
                        <a class="btn btn-primary" href="slide/{name}">Select</a>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
    

    <script>
        // slideList
        var slideDataList = [
            {
                "name": "slide1.md",
                "title": "Demo 1",
                "description": "Slide 1",
            },
            {
                "name": "slide2.md",
                "title": "",
                "description": "Slide 2",
            },
            {
                "name": "slide3.md",
                "title": "ouo",
                "description": "abc",
            },
            {
                "name": "python.md",
                "title": "cpp",
                "description": "12345",
            },
            {
                "name": "none.md",
                "title": "Cpp",
                "description": "go",
            },
            {
                "name": "slide5.md",
                "title": "goof",
                "description": "Slide 1",
            },
        ];
    </script>
    <script>
        var options = {
            // shouldSort: true,
            // threshold: 0.6,
            // location: 0,
            // distance: 100,
            // maxPatternLength: 32,
            // minMatchCharLength: 1,
            keys: [
                "name",
                "title",
            ]
        };

        var fuse = new Fuse(slideDataList, options);
        var result = fuse.search("md");
        console.log(result);

        var slideList = document.getElementById("slideList");
        var cardTemplate = document.getElementById("card-template").children[0];

        console.log( "slideList", slideList )
        console.log( "cardTemplate", cardTemplate )
        for (let i = 0; i < result.length; i++) {
            slideList.appendChild( createCard( result[i].item.name , result[i].item.title , result[i].item.description ));
        }

        function createCard( name , title , description ){
            const clone = cardTemplate.cloneNode(true);
            clone.setAttribute("id", "");
            clone.querySelector(".card-title").innerHTML = title;
            clone.querySelector(".card-text").innerHTML = description;
            clone.querySelector(".card-name").innerHTML = name;
            clone.querySelector(".btn").setAttribute("href", "slide/" + name);
            return clone;
        }

        function search(event) {
            event.preventDefault();
            // clear slideList
            slideList.innerHTML = "";
            
            const searchValue = document.querySelector("input").value;
            console.log("searchValue" , searchValue );
            console.log(searchValue);
            const result = fuse.search(searchValue=="" ? "md": searchValue );
            console.log(result);

            for (let i = 0; i < result.length; i++) {
                slideList.appendChild( createCard( result[i].item.name , result[i].item.title , result[i].item.description ));
            }

        }
    </script>
</body>

</html>